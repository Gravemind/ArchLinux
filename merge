#!/bin/bash

ARG1=$1

if [ "$ARG1" = "-h" ]
then
    echo "usage:"
    echo "    $0 [-h|-l|pattern]"
    exit 0
fi

function mymerge() {
    if [ -n "$ARG1" ]
    then
        if [[ "$2" = *${ARG1}* ]]
        then
            echo "## matching $2"
        else
            echo "## skip $2"
            return
        fi           
    fi

	if [ ! -e "$1" ]
	then
		echo "## not such file or dir: $1"
	fi
	if [ ! -e "$2" ]
	then
		echo "## not such file or dir: $2"
	fi

	MERGER="meld"
	if [ "$OS" = "Windows_NT" ]
	then
		echo "You are on Windows"
		MERGER="/c/Program Files (x86)/Meld/meld/meld.exe"
	fi

    if [ -n "$(diff $1 $2)" ]
    then
        echo "$> $MERGER $1 $2"
        if [ "$ARG1" != "-l" ]
        then
            "$MERGER" $1 $2 # &> /dev/null
        fi
    else
        echo "## ( no diff: $1 $2 )"
    fi
}

mymerge oh-my-zsh-install.sh ~/.oh-my-zsh/tools/install.sh
mymerge ~/bin bin
#mymerge ~/.conky .conky
#mymerge ~/.dzen .dzen
mymerge ~/.emacs.d .emacs.d
mymerge ~/.gitconfig .gitconfig
mymerge ~/.gitignore .gitignore
mymerge ~/.i3 .i3
mymerge ~/.ncmpcpp .ncmpcpp
mymerge ~/.oh-my-zsh/custom .oh-my-zsh/custom
#mymerge ~/oh-my-zsh-install.sh oh-my-zsh-install.sh
mymerge ~/.screenrc .screenrc
#mymerge ~/scripts scripts
#mymerge ~/.userscripts .userscripts
mymerge ~/.Xdefaults .Xdefaults
mymerge ~/.xinitrc .xinitrc
mymerge ~/.zshrc .zshrc
mymerge ~/.config/MusicBrainz/Picard.conf
