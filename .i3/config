# i3 config file (v4)
#
# Please see http://i3wm.org/docs/userguide.html for a complete reference!
#

# Variables
set $ModK           Mod4
set $resize_step    100
set $screenR        DP-4
set $screenL        HDMI-0

set $keyLeft        j
set $keyRight       l
set $keyUp          i
set $keyDown        k

set $layouts        ~/.i3/layouts

ipc-socket ~/.i3/ipc.sock

#
# Style and behaviors
#

# Font for window titles
font xft:DejaVu Sans Mono Bold 9

# hide boarder if single window/container in output
hide_edge_borders smart

# Delay the reset of urgent hint workspace focus
force_display_urgency_hint 500 ms

focus_follows_mouse yes
default_orientation auto
workspace_auto_back_and_forth no
#mouse_warping none

# Default border style: normal[px]|pixel[px]|none
default_border pixel 2
default_floating_border normal 2

# Default border for programs
#for_window [class="^.*"] border pixel 2
#for_window [class="(?i)urxvt"] border pixel 2
#for_window [class="(?i)emacs"] border pixel 2
#for_window [class="(?i)firefox"] border none
#for_window [class="(?i)chromium"] border none
#for_window [class="(?i)pale moon"] border none
#for_window [class="(?i)icecat"] border none
#for_window [class="(?i)mplayer"] border none
#for_window [class="(?i)mpv"] border none

# Colors
# class                 border  backgr. text    indicator child_border
client.focused          #285577 #285577 #dddddd #2e9ef4   #285577
client.focused_inactive #282828 #282828 #888888 #303030   #282828
client.unfocused        #101010 #101010 #555555 #181818   #101010
client.urgent           #900000 #900000 #ffffff #900000   #900000
client.placeholder      #000000 #202020 #888888 #000000   #000000   # borders & indicator ignored
client.background       #202020

#
# Workspaces and outputs
#

# Switch to workspace
bindsym $ModK+1 workspace 1
bindsym $ModK+2 workspace 2
bindsym $ModK+3 workspace 3
bindsym $ModK+4 workspace 4
bindsym $ModK+5 workspace 5
bindsym $ModK+6 workspace 6
bindsym $ModK+7 workspace 7
bindsym $ModK+8 workspace 8
bindsym $ModK+9 workspace 9
bindsym $ModK+0 workspace 10

# Move focused container to workspace
bindsym $ModK+Shift+1 move workspace 1
bindsym $ModK+Shift+2 move workspace 2
bindsym $ModK+Shift+3 move workspace 3
bindsym $ModK+Shift+4 move workspace 4
bindsym $ModK+Shift+5 move workspace 5
bindsym $ModK+Shift+6 move workspace 6
bindsym $ModK+Shift+7 move workspace 7
bindsym $ModK+Shift+8 move workspace 8
bindsym $ModK+Shift+9 move workspace 9
bindsym $ModK+Shift+0 move workspace 10

# Assign workspace to output
workspace 1 output $screenL
workspace 2 output $screenL
workspace 3 output $screenL
workspace 4 output $screenL
workspace 5 output $screenL
workspace 6 output $screenR
workspace 7 output $screenR
workspace 8 output $screenR
workspace 9 output $screenR
workspace 10 output $screenR

# Default workspace assignment for programs
#assign [window_role="^browser$"] → 10
#assign [class="^Pidgin$"] → 9
#for_window [class="(?i)^.*wine.*$"] floating enable
assign [class="(?i)^.*steam.*$"] → 1
#for_window [class="(?i)^UE4Editor.*$"] floating enable
#assign [class="(?i)^UE4Editor.*$"] → 8

#
# Bindings
#

# Use Mouse+ModK to drag floating windows to their wanted position
floating_modifier $ModK

set $locker i3lock -c 404552 && sleep 1
#set $locker sleep 1

# Lock, Restart, Reboot...
set $mode_system "    [l]o[c]k    [e]xit  relo[a]d  [r]estart    [s]uspend  [h]ibernate    [S]hutdown  [R]eboot    "
mode $mode_system {
    bindsym l exec --no-startup-id $locker, mode "default"
    bindsym c exec --no-startup-id $locker, mode "default"
    # Exit i3 (logs you out of your X session)
    bindsym e exec --no-startup-id i3-msg exit, mode "default"
    # Reload i3 configuration file
    bindsym a exec --no-startup-id i3-msg reload, mode "default"
    # Restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
    bindsym r exec --no-startup-id i3-msg restart, mode "default"
    bindsym s exec --no-startup-id $locker && systemctl suspend, mode "default"
    bindsym h exec --no-startup-id $locker && systemctl hibernate, mode "default"
    bindsym Shift+s exec --no-startup-id systemctl poweroff -i, mode "default"
    bindsym Shift+r exec --no-startup-id systemctl reboot, mode "default"
    # back to normal: Enter or Escape
    bindsym q mode "default"
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $ModK+Escape mode $mode_system

# Toggle border decoration
bindsym $ModK+e border toggle

# Kill focused window
bindsym $ModK+q kill

# Move to scrathpad
bindsym $ModK+Shift+grave move scratchpad
# Toggle scratchpad
bindsym $ModK+grave scratchpad show

# Change focus
bindsym $ModK+$keyLeft          focus left
bindsym $ModK+$keyDown          focus down
bindsym $ModK+$keyUp            focus up
bindsym $ModK+$keyRight         focus right
bindsym $ModK+Left              focus left
bindsym $ModK+Down              focus down
bindsym $ModK+Up                focus up
bindsym $ModK+Right             focus right

# Move focused window
bindsym $ModK+Shift+$keyLeft    move left
bindsym $ModK+Shift+$keyDown    move down
bindsym $ModK+Shift+$keyUp      move up
bindsym $ModK+Shift+$keyRight   move right
bindsym $ModK+Shift+Left        move left
bindsym $ModK+Shift+Down        move down
bindsym $ModK+Shift+Up          move up
bindsym $ModK+Shift+Right       move right

# Focus other output (when multi screen)
bindsym $ModK+Tab focus output right

# Split in vertical orientation
bindsym $ModK+v split v

# Split in horizontal orientation
bindsym $ModK+b split h

# Focus the parent container
bindsym $ModK+x focus parent

# Focus the child container
bindsym $ModK+c focus child

# Change container layout
bindsym $ModK+a layout tabbed
bindsym $ModK+s layout stacking
bindsym $ModK+d layout toggle split

# Enter fullscreen mode for the focused container
bindsym $ModK+f fullscreen

# Toggle tiling / floating
bindsym $ModK+Shift+space floating toggle

# Change focus between tiling / floating windows
bindsym $ModK+space focus mode_toggle

# Resize window (you can also use the mouse for that)
set $mode_resize "    [resize]    "
mode $mode_resize {
    bindsym $keyLeft        resize shrink left  $resize_step px
    bindsym Shift+$keyLeft  resize grow   left  $resize_step px
    bindsym $keyDown        resize shrink down  $resize_step px
    bindsym Shift+$keyDown  resize grow   down  $resize_step px
    bindsym $keyUp          resize shrink up    $resize_step px
    bindsym Shift+$keyUp    resize grow   up    $resize_step px
    bindsym $keyRight       resize shrink right $resize_step px
    bindsym Shift+$keyRight resize grow   right $resize_step px
    bindsym Left            resize shrink left  $resize_step px
    bindsym Shift+Left      resize grow   left  $resize_step px
    bindsym Down            resize shrink down  $resize_step px
    bindsym Shift+Down      resize grow   down  $resize_step px
    bindsym Up              resize shrink up    $resize_step px
    bindsym Shift+Up        resize grow   up    $resize_step px
    bindsym Right           resize shrink right $resize_step px
    bindsym Shift+Right     resize grow   right $resize_step px
    bindsym q mode "default"
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $ModK+r mode $mode_resize

#
# Bindings to launch programs
#

# Start dmenu
#bindsym $ModK+z exec dmenu_run -b -p ">>" -nb '#222222' -nf '#CCCCCC' -sb '#4c7899' -sf '#FFFFFF'
#bindsym $ModK+z exec rofi -show run
bindsym $ModK+z exec --no-startup-id "rofi -show combi -combi-modi 'run,ssh,window' -modi combi"

# Cliboard Manager
bindsym $ModK+Insert exec --no-startup-id  "CM_LAUNCHER=rofi clipmenu -p clip"
exec_always --no-startup-id "systemctl --user restart clipmenud.service"

# Overriding Shift-Insert to type what's in primary clipboard (selection)
# (xdotool bugge ? seems to type while Shift is pressed ?)
#bindsym Shift+Insert exec --no-startup-id "bash -c 'xdotool type \\"$(xclip -selection primary -o -r)\\"'
#bindsym Shift+Insert exec --no-startup-id "bash -c 'xclip -selection primary -o -r | xvkbd -xsendevent -delay 1 -file -'"

# Pulse Audio
set $pactl_vol pactl set-sink-volume '@DEFAULT_SINK@'
set $pactl_mute pactl set-sink-mute '@DEFAULT_SINK@' toggle
bindsym $ModK+equal exec --no-startup-id $pactl_vol +5%
bindsym $ModK+minus exec --no-startup-id $pactl_vol -5%
bindsym $ModK+Shift+equal exec --no-startup-id $pactl_vol +10%
bindsym $ModK+Shift+minus exec --no-startup-id $pactl_vol -10%
bindsym XF86AudioRaiseVolume exec --no-startup-id $pactl_vol +5%
bindsym XF86AudioLowerVolume exec --no-startup-id $pactl_vol -5%
bindsym $ModK+XF86AudioRaiseVolume exec --no-startup-id $pactl_vol +5%
bindsym $ModK+XF86AudioLowerVolume exec --no-startup-id $pactl_vol -5%
bindsym $ModK+F12 exec --no-startup-id $pactl_vol +5%
bindsym $ModK+F11 exec --no-startup-id $pactl_vol -5%
bindsym XF86AudioMute exec --no-startup-id $pactl_mute
bindsym $ModK+XF86AudioMute exec --no-startup-id $pactl_mute

# Playerctl
bindsym $ModK+End exec --no-startup-id playerctl play-pause
bindsym $ModK+Prior exec --no-startup-id playerctl previous
bindsym $ModK+Next exec --no-startup-id playerctl next
bindsym XF86AudioPlay exec --no-startup-id playerctl play-pause
bindsym XF86AudioPrev exec --no-startup-id playerctl previous
bindsym XF86AudioNext exec --no-startup-id playerctl next
bindsym XF86AudioStop exec --no-startup-id playerctl pause
bindsym $ModK+XF86AudioPlay exec --no-startup-id playerctl play-pause
bindsym $ModK+XF86AudioPrev exec --no-startup-id playerctl previous
bindsym $ModK+XF86AudioNext exec --no-startup-id playerctl next
bindsym $ModK+XF86AudioStop exec --no-startup-id playerctl pause
#bindsym $ModK+F8 exec --no-startup-id playerctl play-pause
#bindsym $ModK+F9 exec --no-startup-id playerctl previous
#bindsym $ModK+F10 exec --no-startup-id playerctl next

# MPD
#bindsym $ModK+End exec --no-startup-id mpc -q toggle
#bindsym $ModK+Prior exec --no-startup-id mpc -q prev
#bindsym $ModK+Next exec --no-startup-id mpc -q next
#bindsym XF86AudioPlay exec --no-startup-id mpc -q toggle
#bindsym XF86AudioPrev exec --no-startup-id mpc -q prev
#bindsym XF86AudioNext exec --no-startup-id mpc -q next
#bindsym XF86AudioStop exec --no-startup-id mpc -q stop
#bindsym $ModK+XF86AudioPlay exec --no-startup-id mpc -q toggle
#bindsym $ModK+XF86AudioPrev exec --no-startup-id mpc -q prev
#bindsym $ModK+XF86AudioNext exec --no-startup-id mpc -q next
#bindsym $ModK+XF86AudioStop exec --no-startup-id mpc -q stop
##bindsym $ModK+F8 exec --no-startup-id mpc -q toggle
##bindsym $ModK+F9 exec --no-startup-id mpc -q prev
##bindsym $ModK+F10 exec --no-startup-id mpc -q next

# On/Off Touchpad
bindsym XF86TouchpadToggle exec zsh ~/bin/toggletouchpad

# Lock
#bindsym $ModK+w exec --no-startup-id "/bin/bash --login -c 'sleep 0.5; xtrlock; exit 0'"
bindsym $ModK+w exec --no-startup-id i3lock -c 222222

# Terminal
#bindsym $ModK+Return exec $layouts/launch.sh urxvt
bindsym $ModK+Return exec urxvt

# Emacs
bindsym $ModK+Shift+Return exec $layouts/launch.sh -- emacs
bindsym $ModK+Ctrl+Return exec $layouts/launch.sh -- emacs ~/TODO.org

# Firefox
bindsym $ModK+F10 exec $layouts/launch.sh -w 10 firefox

# Qalculate
bindsym $ModK+F5 exec $layouts/launch.sh qalculate-gtk -n

# Redshift
bindsym $ModK+o exec --no-startup-id ~/bin/red +1
bindsym $ModK+p exec --no-startup-id ~/bin/red -1
bindsym $ModK+Shift+o exec --no-startup-id ~/bin/red -c +1
bindsym $ModK+Shift+p exec --no-startup-id ~/bin/red -c -1

# Go to urgent window, and go back
bindsym $ModK+BackSpace exec --no-startup-id ~/.i3/goto_urgent_and_back.sh

#
# Bar
#

# Bar
bar { # bar
    status_command i3status -c ~/.i3/i3status.conf
    separator_symbol "   "
    mode hide
    position bottom
    colors {
        background #101010
        statusline #E0E0E0
    }
}

#
# Run at startup
#

#exec ~/.i3/bar/bar.py
exec --no-startup-id ~/.i3/bg.py
#exec conky -c ~/.conky/balloon/conkyrc

#
# Spawn layouts and programs
# http://i3wm.org/docs/layout-saving.html
#
exec --no-startup-id $layouts/startup.sh

set $hook_idle_time_min 10
exec --no-startup-id xautolock -detectsleep -time $hook_idle_time_min -locker "~/bin/hooks/onidle" -noclose

#exec i3lock -c 222222
